# ðŸŽ® Quiz Battle - TÃ­nh nÄƒng má»›i

## âœ¨ CÃ¡c tÃ­nh nÄƒng Ä‘Ã£ thÃªm

### 1. ðŸŽ¯ Theo dÃµi tiáº¿n Ä‘á»™ cÃ¢u há»i
- **Äiá»u hÆ°á»›ng cÃ¢u há»i**: Hiá»ƒn thá»‹ cÃ¡c nÃºt sá»‘ (1, 2, 3...) cho táº¥t cáº£ cÃ¢u há»i
  - XÃ¡m: CÃ¢u chÆ°a tráº£ lá»i
  - Xanh: CÃ¢u tráº£ lá»i Ä‘Ãºng
  - Äá»: CÃ¢u tráº£ lá»i sai
  - Viá»n tráº¯ng: CÃ¢u há»i hiá»‡n táº¡i
- **Click Ä‘á»ƒ chuyá»ƒn**: Nháº¥p vÃ o sá»‘ báº¥t ká»³ Ä‘á»ƒ chuyá»ƒn Ä‘áº¿n cÃ¢u há»i Ä‘Ã³
- **NÃºt "Tiáº¿p tá»¥c"**: Tá»± Ä‘á»™ng nháº£y Ä‘áº¿n cÃ¢u há»i chÆ°a tráº£ lá»i tiáº¿p theo

### 2. ðŸ† MÃ n hÃ¬nh hoÃ n thÃ nh
Khi há»c sinh hoÃ n thÃ nh táº¥t cáº£ cÃ¢u há»i hoáº·c háº¿t thá»i gian:
- **Thá»‘ng kÃª chi tiáº¿t**:
  - Háº¡ng cuá»‘i cÃ¹ng (#1, #2, ...)
  - Sá»‘ cÃ¢u Ä‘Ãºng/tá»•ng sá»‘ cÃ¢u
  - Äá»™ chÃ­nh xÃ¡c (%)
  - Tá»•ng XP kiáº¿m Ä‘Æ°á»£c
- **Báº£ng xáº¿p háº¡ng cuá»‘i**: Thá»© háº¡ng cá»§a táº¥t cáº£ ngÆ°á»i chÆ¡i
- **Ghi chÃº cho giÃ¡o viÃªn**: Nháº¯c nhá»Ÿ ráº±ng battle chá»‰ Ä‘á»ƒ xáº¿p háº¡ng, khÃ´ng tá»± Ä‘á»™ng cá»™ng Ä‘iá»ƒm

### 3. ðŸ‘¨â€ðŸ« Quyá»n Admin/GiÃ¡o viÃªn

#### Káº¿t thÃºc battle sá»›m
- **NÃºt "Káº¿t thÃºc Battle"**: Xuáº¥t hiá»‡n khi:
  - User lÃ  admin hoáº·c staff (giÃ¡o viÃªn)
  - Battle Ä‘ang trong tráº¡ng thÃ¡i `in_progress`
- **XÃ¡c nháº­n**: Há»i trÆ°á»›c khi káº¿t thÃºc
- **Tá»± Ä‘á»™ng chuyá»ƒn**: Chuyá»ƒn battle sang tráº¡ng thÃ¡i `completed`

#### Xem káº¿t quáº£ battle Ä‘Ã£ káº¿t thÃºc
- **Danh sÃ¡ch battles**: Pháº§n "ÄÃ£ káº¿t thÃºc"
- **NÃºt "Xem káº¿t quáº£"**: Click Ä‘á»ƒ xem mÃ n hÃ¬nh hoÃ n thÃ nh
- **Dá»¯ liá»‡u Ä‘áº§y Ä‘á»§**: 
  - Báº£ng xáº¿p háº¡ng cuá»‘i cÃ¹ng
  - Sá»‘ cÃ¢u Ä‘Ãºng cá»§a tá»«ng há»c sinh
  - Thá»i gian hoÃ n thÃ nh
  - Äiá»ƒm XP (chá»‰ tham kháº£o)

### 4. ðŸŽµ Nháº¡c ná»n gay cáº¥n
- **Tá»± Ä‘á»™ng phÃ¡t**: Khi battle Ä‘ang diá»…n ra
- **NÃºt Ä‘iá»u khiá»ƒn**: GÃ³c dÆ°á»›i pháº£i mÃ n hÃ¬nh
  - Icon ðŸ”Š: Äang phÃ¡t
  - Icon ðŸ”‡: ÄÃ£ táº¯t
- **Web Audio API**: Nháº¡c Ä‘Æ°á»£c táº¡o báº±ng code, khÃ´ng cáº§n file mp3
- **Hiá»‡u á»©ng**:
  - Bass line máº¡nh máº½
  - Chord cÄƒng tháº³ng
  - Tremolo effect
  - Nhá»‹p Ä‘áº­p (pulse) 800ms

### 5. ðŸ“Š LÆ°u Ã½ vá» Ä‘iá»ƒm sá»‘

#### âš ï¸ QUAN TRá»ŒNG
**Quiz Battle KHÃ”NG tá»± Ä‘á»™ng cá»™ng Ä‘iá»ƒm vÃ o tÃ i khoáº£n há»c sinh!**

#### Má»¥c Ä‘Ã­ch
- Battle chá»‰ dÃ¹ng Ä‘á»ƒ **xáº¿p háº¡ng** há»c sinh
- GiÃºp giÃ¡o viÃªn Ä‘Ã¡nh giÃ¡ nhanh nÄƒng lá»±c tÆ°Æ¡ng Ä‘á»‘i

#### CÃ¡ch cá»™ng Ä‘iá»ƒm
1. Sau khi battle káº¿t thÃºc, vÃ o pháº§n "ÄÃ£ káº¿t thÃºc"
2. Click "Xem káº¿t quáº£" cá»§a battle Ä‘Ã³
3. Xem báº£ng xáº¿p háº¡ng cuá»‘i cÃ¹ng:
   - Háº¡ng 1: ...Ä‘iá»ƒm
   - Háº¡ng 2: ...Ä‘iá»ƒm
   - Háº¡ng 3: ...Ä‘iá»ƒm
   - ...
4. **Cá»™ng Ä‘iá»ƒm thá»§ cÃ´ng** cho tá»«ng há»c sinh dá»±a trÃªn thá»© háº¡ng

#### VÃ­ dá»¥
```
Battle #5 - Káº¿t quáº£:
#1: Nguyá»…n VÄƒn A - 6/6 Ä‘Ãºng - 150 XP
#2: Tráº§n Thá»‹ B - 5/6 Ä‘Ãºng - 125 XP
#3: LÃª VÄƒn C - 4/6 Ä‘Ãºng - 100 XP
#4: Pháº¡m Thá»‹ D - 3/6 Ä‘Ãºng - 75 XP

GiÃ¡o viÃªn cá»™ng Ä‘iá»ƒm:
- Nguyá»…n VÄƒn A: +10 Ä‘iá»ƒm (Nháº¥t)
- Tráº§n Thá»‹ B: +8 Ä‘iá»ƒm (NhÃ¬)
- LÃª VÄƒn C: +6 Ä‘iá»ƒm (Ba)
- Pháº¡m Thá»‹ D: +4 Ä‘iá»ƒm (Tham gia)
```

## ðŸ”§ API Endpoints má»›i

### 1. Káº¿t thÃºc battle
```
POST /api/heritage/battles/{id}/end_battle/
Headers: Authorization: Bearer {token}

Response:
{
  "message": "ÄÃ£ káº¿t thÃºc battle thÃ nh cÃ´ng",
  "battle": {...}
}
```

**YÃªu cáº§u**: User pháº£i lÃ  `is_staff=True` hoáº·c `is_superuser=True`

## ðŸŽ¨ Components má»›i

### 1. BattleMusic.tsx
Component phÃ¡t nháº¡c ná»n sá»­ dá»¥ng Web Audio API:
- Tá»± Ä‘á»™ng phÃ¡t khi battle active
- NÃºt mute/unmute á»Ÿ gÃ³c dÆ°á»›i pháº£i
- Volume: 15% (khÃ´ng quÃ¡ to)

### 2. BattleArena.tsx (cáº­p nháº­t)
- ThÃªm question navigator
- ThÃªm completion screen
- ThÃªm nÃºt káº¿t thÃºc battle (admin only)
- TÃ­ch há»£p BattleMusic
- Check quyá»n admin

## ðŸ“± Responsive Design
Táº¥t cáº£ tÃ­nh nÄƒng má»›i Ä‘á»u hoáº¡t Ä‘á»™ng tá»‘t trÃªn:
- Desktop (>= 768px)
- Tablet (>= 640px)
- Mobile (< 640px)

## ðŸš€ HÆ°á»›ng dáº«n sá»­ dá»¥ng

### Cho Há»c sinh
1. VÃ o pháº§n "Quiz Battle" tá»« menu
2. Chá» giÃ¡o viÃªn táº¡o battle vÃ  thÃªm báº¡n vÃ o
3. Click "Tham gia" khi battle báº¯t Ä‘áº§u
4. Tráº£ lá»i cÃ¡c cÃ¢u há»i:
   - Xem tiáº¿n Ä‘á»™ á»Ÿ thanh sá»‘ cÃ¢u
   - Click sá»‘ Ä‘á»ƒ xem láº¡i cÃ¢u Ä‘Ã£ tráº£ lá»i
   - DÃ¹ng nÃºt "Tiáº¿p tá»¥c" Ä‘á»ƒ nháº£y Ä‘áº¿n cÃ¢u chÆ°a lÃ m
5. Xem káº¿t quáº£ cuá»‘i cÃ¹ng vÃ  thá»© háº¡ng

### Cho GiÃ¡o viÃªn
1. Táº¡o battle má»›i vá»›i danh sÃ¡ch há»c sinh
2. Click "Báº¯t Ä‘áº§u" Ä‘á»ƒ khá»Ÿi Ä‘á»™ng battle
3. Trong battle:
   - Theo dÃµi báº£ng xáº¿p háº¡ng real-time
   - Náº¿u cáº§n káº¿t thÃºc sá»›m: Click "Káº¿t thÃºc Battle"
4. Sau khi káº¿t thÃºc:
   - VÃ o pháº§n "ÄÃ£ káº¿t thÃºc"
   - Click "Xem káº¿t quáº£" cá»§a battle
   - Ghi láº¡i báº£ng xáº¿p háº¡ng
   - Cá»™ng Ä‘iá»ƒm thá»§ cÃ´ng cho há»c sinh

## ðŸŽ¯ Lá»£i Ã­ch

### Cho Há»c sinh
- âœ… Biáº¿t rÃµ tiáº¿n Ä‘á»™ lÃ m bÃ i
- âœ… CÃ³ thá»ƒ xem láº¡i cÃ¢u Ä‘Ã£ lÃ m
- âœ… KhÃ´ng bá» sÃ³t cÃ¢u há»i nÃ o
- âœ… Tháº¥y káº¿t quáº£ vÃ  thá»© háº¡ng ngay láº­p tá»©c
- âœ… Nháº¡c ná»n tÄƒng há»©ng thÃº

### Cho GiÃ¡o viÃªn
- âœ… Kiá»ƒm soÃ¡t hoÃ n toÃ n thá»i gian battle
- âœ… Káº¿t thÃºc sá»›m khi cáº§n thiáº¿t
- âœ… Xem láº¡i káº¿t quáº£ báº¥t cá»© lÃºc nÃ o
- âœ… Dá»… dÃ ng Ä‘Ã¡nh giÃ¡ vÃ  cá»™ng Ä‘iá»ƒm
- âœ… Dá»¯ liá»‡u lÆ°u trá»¯ vÄ©nh viá»…n

## ðŸ”’ Báº£o máº­t
- Chá»‰ admin/giÃ¡o viÃªn má»›i káº¿t thÃºc battle Ä‘Æ°á»£c
- Token Ä‘Æ°á»£c verify á»Ÿ backend
- Unauthorized request sáº½ bá»‹ tá»« chá»‘i vá»›i HTTP 403

## ðŸ“Š Dá»¯ liá»‡u lÆ°u trá»¯
- Táº¥t cáº£ káº¿t quáº£ battle Ä‘Æ°á»£c lÆ°u trong database
- KhÃ´ng bao giá» máº¥t dá»¯ liá»‡u
- CÃ³ thá»ƒ xem láº¡i má»i lÃºc
- Export Ä‘Æ°á»£c náº¿u cáº§n

---

**PhÃ¡t triá»ƒn bá»Ÿi**: Quiz Battle Team
**Version**: 2.0
**NgÃ y cáº­p nháº­t**: 3/11/2025
